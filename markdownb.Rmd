---
title: "Trabalho de ECBD"
author: "Joana Araújo, Mariana Silva, Tiago Silva"
date: "2023-04-13"
output: html_document
---
# Explicação dos dados: 
A caracterização molecular do cancro da mama é um dos objectivos da investigação do TCGA-BRCA. A informação foi recolhida como resultado de uma parceria entre o Nation Cancer Institute (NCI) e o National Human Genome Research Institute, e inclui dados clínicos, genómicos e transcriptómicos para mais de 1.000 doentes com cancro da mama (NHGRI). Os dados incluem detalhes clínicos sobre os pacientes, tais como a sua idade, sexo, fase do tumor e história do tratamento, bem como informação sobre as anomalias genómicas e transcriptómicas que ocorrem no cancro da mama.
#Origem:
O projecto TCGA-BRCA foi lançado como uma componente do esforço maior do TCGA, que procurou oferecer um inventário extensivo de alterações genéticas em vários tipos de cancro. Muitos métodos genómicos e transcriptómicos, incluindo sequenciação de todo o genoma, sequenciação de todo o exoma, sequenciação de RNA, e perfil de metilação de ADN, foram utilizados no projecto TCGA-BRCA para analisar amostras de cancro da mama em larga escala.

#Relevância:

Devido uo facto de dar uma visão completa das modificações genómicas e transcriptómicas que ocorrem no cancro da mama, os dados do TCGA-BRCA são uma fonte importante para os investigadores que analisam esta doença. A informação pode ser utilizada para descobrir anomalias genéticas e epigenéticas únicas que apoiam o aparecimento e a propagação do cancro da mama, bem como para encontrar alvos terapêuticos prospectivos. O conjunto de dados TCGA-BRCA contém dados clínicos que podem ser utilizados para examinar a ligação entre alterações genéticas e resultados do paciente, bem como para encontrar biomarcadores que possam ser utilizados para prever o prognóstico de um paciente e a resposta ao tratamento. Os dados de TCGA-BRCA como um todo têm o potencial para melhorar drasticamente a nossa compreensão do cancro da mama e para orientar a criação de tratamentos mais eficientes para esta condição.

#Preparação e preprocessamento
```{r}
proj <- "TCGA-BRCA"
query <- GDCquery(
  project = proj,
  data.category = "Transcriptome Profiling", 
  data.type = "Gene Expression Quantification",
  workflow.type = "STAR - Counts"
)
GDCdownload(query)
data_rna_brca  <- GDCprepare(query)

class(data_rna_brca)
dim(data_rna_brca)
```

```{r}
qplot(data_rna_brca$definition) 
```
```{r}
str(data_rna_brca)
```


```{r}
colnames(data_rna_brca)
```


```{r}
assayNames(data_rna_brca)
```


```{r}
head(data_rna_brca)
```


#DESeq
```{r}
data_de <- data_rna_brca[,!is.na(data_rna_brca$definition)]

ddsSE <- DESeqDataSet(data_de, design = ~ definition)

keep <- rowSums(counts(ddsSE)) >= 10
ddsSE <- ddsSE[keep,]
ddsSE =DESeq(ddsSE)

resultsNames(ddsSE)

res1 <- results(ddsSE, name = "definition_Primary.solid.Tumor_vs_Metastatic")
res1
res2<- results(ddsSE, name = "definition_Solid.Tissue.Normal_vs_Metastatic")

dea1 <- as.data.frame(res1)
dea2 <- as.data.frame(res2)

plot(dea1)
plot(dea2)
```


#exploração dos resultados- res1
```{r}
res1Ordered =res1[order(res1$padj),]
summary(res1)
```
```{r}
sum(res1$padj < 0.1, na.rm=TRUE)
```


Número total de genes com reads diferentes de 0: 56.713

Número de genes que apresentam um log2 fold change (LFC) maior que 0: 897 genes, o que representa 1,6% do total de genes analisados. Isso indica que esses genes estão sobrexpressos no grupo experimental do que no grupo controle.

Número de genes que apresentam um log2 fold change menor que 0: 626 genes, o que representa 1,1% do total de genes analisados. Isso indica que esses genes estão subexpressos no grupo experimental do que no grupo controle.

Percentagem de outliers: 0%

Percentagem de genes com baixo valor de reads: 39%, ou seja, genes que têm uma contagem média inferior a 1, isso indica que esses genes são subexpressos e, portanto, menos confiáveis.

```{r}
sum(res2$padj < 0.1, na.rm=TRUE)
```

1523 genes diferencialmente expressos dos quais 897 são sobrexpressos e 626 são subexpressos

#exploração dos resultados res2
```{r}
res2Ordered =res2[order(res2$padj),]
summary(res2)
```
Número total de genes com contagem de leitura diferente de zero: 56.713

Número de genes que apresentam um log2 fold change (LFC) maior que 0: 4.150 genes, o que representa 7,3% do total de genes analisados. Isso indica que esses genes estão sobrexpressos no grupo experimental do que no grupo controle.

Número de genes que apresentam um log2 fold change menor que 0: 5.400 genes, o que representa 9,5% do total de genes analisados. Isso indica que esses genes estão subexpressos no grupo experimental do que no grupo controle.

Percentagem de outliers: 0%

Percentagem de genes com contagens baixas: 37%, ou seja, genes que têm uma contagem média inferior a 1. Isso pode indicar que esses genes são pouco expressos e, portanto, menos confiáveis.

```{r}
sum(res2$padj < 0.1, na.rm=TRUE)
```

9550 genes diferencialmente expressos dos quais 4150 são sobrexpressos e 5400 são subexpressos

```{r}
vst = varianceStabilizingTransformation(ddsSE,blind = FALSE)
head(assay(vst),3)
```
```{r}
head(counts(ddsSE),3)
```
```{r}
select = rownames(head(res1Ordered,20))
vst.counts = assay(vst)[select,]
df = as.data.frame(colData(ddsSE)[,c("definition")])
pheatmap(vst.counts,cluster_rows = FALSE)
```

```{r}
select = rownames(head(res2Ordered,20))
vst.counts = assay(vst)[select,]
df = as.data.frame(colData(ddsSE)[,c("definition")])
pheatmap(vst.counts,cluster_rows = FALSE)
```


